{% extends "layout.html" %}
{% block content %}

	<div class="">
				<h6><i class="fa fa-money"></i> Tax Information</h6>
				<ul class="bodymenu">
					<li>
						<a href="{{ url_for('users.employees')}}" class="active"><small>Active List</small></a>
					</li>
					
					
				</ul>
				<div class="bodycontent">
					<table id="example" class="table table-striped table-bordered table-sm">
						<thead>
							<th>Staff ID</th>
							<th>Name</th>
							<th>Taxable</th>
							<th>Min Tax</th>
							<th>Higher Tax</th>
							<th>Effective Tax</th>
							<th colspan="6" style="text-align: center;">Tax Bands</th>
							
							<th>Total Tax</th>							
							<th></th>

						</thead>
						<thead>
							<th colspan="6"></th>
							
							<th>1</th>
							<th>2</th>
							<th>3</th>
							<th>4</th>
							<th>5</th>
							<th>6</th>
							<th>Total Tax</th>							
							<th></th>
						</thead>
						<tbody>
							{% if taxinfo %}
								{% for tax in taxinfo %}
							<tr>
								<td>{{ tax[0] }}</td>
								<td>{{ tax[1] }}</td>
								<td>{{ tax[2] | numberFormat}}</td>
								<td>{{ tax[3] | numberFormat}}</td>
								<td>{{ tax[4] | numberFormat}}</td>
								<td>{{ tax[5] | numberFormat }}</td>
								<td>{{ tax[6] | numberFormat}}</td>
								<td>{{ tax[7] | numberFormat}}</td>
								<td>{{ tax[8] | numberFormat}}</td>
								<td>{{ tax[9] | numberFormat}}</td>
								<td>{{ tax[10] | numberFormat}}</td>
								<td>{{ tax[11] | numberFormat}}</td>
								<td>{{ tax[12] | numberFormat}}</td>
								<td>
									<button class="btn btn-sm btn-primary tax__modal" id="tax_{{tax[0]}}"
											data-id="{{ tax[13]}}" 
											data-staff="{{ tax[0]}}"
											data-name="{{ tax[1]}}"
											data-taxable="{{ tax[2]}}"
											data-mintax="{{ tax[3]}}"
											data-highertax="{{ tax[4]}}"
											data-effective="{{ tax[5]}}"
											data-band1="{{ tax[6]}}"
											data-band2="{{ tax[7]}}"
											data-band3="{{ tax[8]}}"
											data-band4="{{ tax[9]}}"
											data-band5="{{ tax[10]}}"
											data-band6="{{ tax[11]}}"
											data-total="{{ tax[12]}}">

										<i class="fa fa-edit "></i>
									</button>
								</td>
							</tr>
								{% endfor %}
							{% endif %}
						</tbody>
					</table>

				</div>
			</div>

<div class="modal fade" tabindex="-1" role="dialog" id="taxmodal" data-backdrop="static" data-keyboard="false" >
      <div class="modal-dialog modal-md" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h4 class="modal-title">Update Tax Information</h4>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          </div>
          <div class="modal-body">
           	<form action="{{ url_for('payroll.tax') }}" method="post" id="taxform">
	           	<div class="container">
		           	<div class="row">
		           		<div class="col-xs-12 col-md-4">
		           			<div class="form-group">
		           				<label>Staff ID</label>
		           				<input type="text" name="staffid" id="staffid" disabled class="form-control">
		           				<input type="hidden" name="emp_id" id="emp_id">
		           			</div>
		           		</div>
		           		<div class="col-xs-12 col-md-4">
		           			<div class="form-group">
		           				<label>Name</label>
		           				<input type="text" name="name" id="name" disabled class="form-control">
		           			</div>
		           		</div>
		           		<div class="col-xs-12 col-md-4">
		           			<div class="form-group">
		           				<label>Taxable</label>
		           				<input type="text" name="taxable" id="taxable" class="form-control">
		           			</div>
		           		</div>
		           	</div>
		           	<div class="row">
		           		<div class="col-xs-12 col-md-4">
		           			<div class="form-group">
		           				<label>Minimum Tax</label>
		           				<input type="text" name="mintax" id="mintax" class="form-control">
		           			</div>
		           		</div>
		           		<div class="col-xs-12 col-md-4">
		           			<div class="form-group">
		           				<label>Higher Tax</label>
		           				<input type="text" name="highertax" id="highertax" class="form-control">
		           			</div>
		           		</div>
		           		<div class="col-xs-12 col-md-4">
		           			<div class="form-group">
		           				<label>Effective Tax</label>
		           				<input type="text" name="effective" id="effective" class="form-control">
		           			</div>
		           		</div>
		           	</div>
		           	<div class="row">
		           		<div class="col-xs-12 col-md-4">
		           			<div class="form-group">
		           				<label>Band 1</label>
		           				<input type="text" name="band1" id="band1" class="form-control">
		           			</div>
		           		</div>
		           		<div class="col-xs-12 col-md-4">
		           			<div class="form-group">
		           				<label>Band 2</label>
		           				<input type="text" name="band2" id="band2" class="form-control">
		           			</div>
		           		</div>
		           		<div class="col-xs-12 col-md-4">
		           			<div class="form-group">
		           				<label>Band 3</label>
		           				<input type="text" name="band3" id="band3" class="form-control">
		           			</div>
		           		</div>
		           	</div>
		           	<div class="row">
		           		<div class="col-xs-12 col-md-4">
		           			<div class="form-group">
		           				<label>Band 4</label>
		           				<input type="text" name="band4" id="band4" class="form-control">
		           			</div>
		           		</div>
		           		<div class="col-xs-12 col-md-4">
		           			<div class="form-group">
		           				<label>Band 5</label>
		           				<input type="text" name="band5" id="band5" class="form-control">
		           			</div>
		           		</div>
		           		<div class="col-xs-12 col-md-4">
		           			<div class="form-group">
		           				<label>Band 6</label>
		           				<input type="text" name="band6" id="band6" class="form-control">
		           			</div>
		           		</div>
		           	</div>
		           	<div class="row">
		           		<div class="col-xs-12 col-md-4">
		           			<div class="form-group">
		           				<label>Total Tax</label>
		           				<input type="text" name="total" id="total" class="form-control">
		           			</div>
		           		</div>
		           	</div>
	           	</div>           	
           	</form>
          	</div>
          <div class="modal-footer">
            <button type="button" class="btn btn-danger btn-sm" data-dismiss="modal">Cancel</button>
            <button type="submit" class="btn btn-success btn-sm" form="taxform">Update</button>
          </div>
        </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->
{% endblock content %}


{% block script %}
<script>
	$(document).ready(function () {
		$('#example').dataTable({
			"iDisplayLength": 50
		});

	});


	$('.tax__modal').click(function(e){
		
		e.preventDefault();

		const id = $(this).attr('id');
		var emp_id = document.getElementById(id).dataset.id,
			staff = document.getElementById(id).dataset.staff,
			name = document.getElementById(id).dataset.name,
			taxable = document.getElementById(id).dataset.taxable,
			mintax = document.getElementById(id).dataset.mintax,
			highertax = document.getElementById(id).dataset.highertax,
			effective = document.getElementById(id).dataset.effective,
			band1 = document.getElementById(id).dataset.band1,
			band2 = document.getElementById(id).dataset.band2,
			band3 = document.getElementById(id).dataset.band3,
			band4 = document.getElementById(id).dataset.band4,
			band5 = document.getElementById(id).dataset.band5,
			band6 = document.getElementById(id).dataset.band6,
			total = document.getElementById(id).dataset.total;

		
		
		document.getElementById('emp_id').value = emp_id;
		document.getElementById('staffid').value = staff;
		document.getElementById('name').value = name;
		document.getElementById('taxable').value = taxable;
		document.getElementById('mintax').value = mintax;
		document.getElementById('highertax').value = highertax;
		document.getElementById('effective').value = effective;
		document.getElementById('band1').value = band1;
		document.getElementById('band2').value = band2;
		document.getElementById('band3').value = band3;
		document.getElementById('band4').value = band4;
		document.getElementById('band5').value = band5;
		document.getElementById('band6').value = band6;
		document.getElementById('total').value = total;
		
		$('#taxmodal').modal('show');
	});

</script>
{% endblock %}